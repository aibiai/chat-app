<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>&#35282;&#33394;&#32452; - &#26435;&#38480;&#31649;&#29702;</title>
  <link rel="stylesheet" href="/admin/static/styles.css" />
  </head>
  <body class="admin-layout">
    <aside class="admin-sidebar">
      <div class="sidebar-top">
        <div class="sidebar-logo">
          <span class="logo-dot"></span>
          <strong>&#25511;&#21046;&#21488;</strong>
        </div>
        <div class="sidebar-profile">
          <div class="sidebar-avatar" id="sidebar-avatar">A</div>
          <div>
            <p id="admin-name" class="sidebar-name">&#31649;&#29702;&#21592;</p>
            <span class="sidebar-status">&#22312;&#32447;</span>
          </div>
        </div>
      </div>
            <nav class="admin-nav">
        <a class="nav-item" href="/admin/dashboard">
          <span>控制台</span>
          <small class="nav-tag hot">HOT</small>
        </a>
        <details class="nav-group">
          <summary class="nav-item">
            <span>常规管理</span>
          </summary>
          <div class="nav-sub">
            <a class="nav-sub-item" href="/admin/profile">个人资料</a>
            <a class="nav-sub-item" href="#">栏目配置</a>
            <a class="nav-sub-item" href="#">缓存清理</a>
          </div>
        </details>
        <details class="nav-group">
          <summary class="nav-item">
            <span>信息审核</span>
          </summary>
          <div class="nav-sub">
            <a class="nav-sub-item" href="/admin/attachments">附件审核</a>
            <a class="nav-sub-item" href="/admin/avatar-review">头像审核</a>
            <a class="nav-sub-item" href="/admin/identity-review">身份审核</a>
            <a class="nav-sub-item" href="/admin/confession-review">表白墙审核</a>
          </div>
        </details>
        <details class="nav-group">
          <summary class="nav-item">
            <span>权限管理</span>
          </summary>
          <div class="nav-sub">
            <a class="nav-sub-item" href="/admin/admins">管理员管理</a>
            <a class="nav-sub-item" href="/admin/admin-logs">管理员日志</a>
            <a class="nav-sub-item" href="/admin/roles">角色组</a>
            <a class="nav-sub-item" href="/admin/rules">菜单规则</a>
          </div>
        </details>
        <details class="nav-group">
          <summary class="nav-item">
            <span>即时通信管理</span>
          </summary>
          <div class="nav-sub">
            <a class="nav-sub-item" href="/admin/push">推送消息</a>
            <a class="nav-sub-item" href="/admin/service-accounts">服务账号管理</a>
          </div>
        </details>
        <details class="nav-group">
          <summary class="nav-item">
            <span>会员管理</span>
          </summary>
          <div class="nav-sub">
            <a class="nav-sub-item" href="/admin/members">会员管理</a>
            <a class="nav-sub-item" href="/admin/customer-service">客服管理</a>
            <a class="nav-sub-item" href="/admin/member-upgrade">升级会员</a>
          </div>
        </details>
        <details class="nav-group">
          <summary class="nav-item">
            <span>礼物管理</span>
          </summary>
          <div class="nav-sub">
            <a class="nav-sub-item" href="/admin/gift-categories">礼物分类</a>
            <a class="nav-sub-item" href="/admin/gifts">礼物管理</a>
          </div>
        </details>
        <a class="nav-item" href="/admin/stickers">
          <span>表情贴管理</span>
        </a>
        <details class="nav-group">
          <summary class="nav-item">
            <span>订单管理</span>
          </summary>
          <div class="nav-sub">
            <a class="nav-sub-item" href="/admin/order-overview">总营业额</a>
            <a class="nav-sub-item" href="/admin/recharge-records">充值记录</a>
            <a class="nav-sub-item" href="/admin/coin-consumption">金币消费记录</a>
            <a class="nav-sub-item" href="/admin/card-review">点卡审核</a>
          </div>
        </details>
        <details class="nav-group">
          <summary class="nav-item">
            <span>前端管理</span>
          </summary>
          <div class="nav-sub">
            <a class="nav-sub-item" href="/admin/frontend-terms">使用条款修改</a>
            <a class="nav-sub-item" href="/admin/frontend-privacy">隐私条款修改</a>
            <a class="nav-sub-item" href="/admin/frontend-security">交友安全修改</a>
            <a class="nav-sub-item" href="/admin/frontend-help">帮助中心修改</a>
            <a class="nav-sub-item" href="/admin/frontend-contact">联系我们修改</a>
            <a class="nav-sub-item" href="/admin/frontend-user-config">用户参数修改</a>
            <a class="nav-sub-item" href="/admin/frontend-card-redeem">点卡兑换内容修改</a>
            <a class="nav-sub-item" href="/admin/frontend-confession-images">表白墙图片修改</a>
          </div>
        </details>

      </nav>
      <button type="button" class="logout-btn" id="logout-btn">&#36864;&#20986;&#30331;&#24405;</button>
    </aside>

    <main class="admin-main">
      <header class="admin-topbar">
        <div>
          <h1>&#35282;&#33394;&#32452;</h1>
          <p class="topbar-subtitle">
            &#32479;&#31649;&#30693;&#24072;&nbsp;/&nbsp;&#31649;&#29702;&#21592;&#30340;&#26435;&#38480;&#25351;&#23450;&#65292;&#25317;&#26377;&#20840;&#23616;&#32467;&#26500;&#65292;&#26041;&#20415;&#26631;&#20934;&#37197;&#32622;&#12290;
          </p>
        </div>
        <div class="topbar-actions">
          <button class="topbar-icon" id="roles-refresh" aria-label="&#21047;&#26032;">
            <svg viewBox="0 0 24 24" width="18" height="18" fill="currentColor">
              <path d="M17.65 6.35A7.95 7.95 0 0 0 12 4V1L7 6l5 5V7a5 5 0 1 1-5 5H5a7 7 0 1 0 12.65-5.65Z" />
            </svg>
          </button>
        </div>
      </header>

      <section class="panel">
        <header class="panel-head">
          <div class="panel-actions">
            <button class="panel-btn primary" id="roles-add">+ &#26032;&#22686;</button>
            <button class="panel-btn" id="roles-edit">&#32534;&#36753;</button>
            <button class="panel-btn danger" id="roles-delete">&#21024;&#38500;</button>
          </div>
        </header>

        <div class="table-wrapper">
          <table class="data-table" id="roles-table">
            <thead>
              <tr>
                <th><input type="checkbox" id="roles-check-all" /></th>
                <th>ID</th>
                <th>&#29238;&#32452;ID</th>
                <th>&#35282;&#33394;&#32452;&#21517;&#31216;</th>
                <th>&#29366;&#24577;</th>
                <th>&#25805;&#20316;</th>
              </tr>
            </thead>
            <tbody>
              <tr><td colspan="6" class="empty">&#21152;&#36733;&#20013;...</td></tr>
            </tbody>
          </table>
        </div>
      </section>
    </main>

    <!-- 角色组新增弹窗（参考截图样式，含权限树） -->
    <div id="role-modal" class="modal-mask" style="display:none;">
      <div class="modal-card">
        <header class="modal-head">
          <h3 id="role-modal-title">添加角色组</h3>
          <button class="modal-close" id="role-modal-close" aria-label="关闭">×</button>
        </header>
        <div class="modal-body">
          <form id="role-form">
            <label class="modal-field">
              <span>父级</span>
              <select id="role-parent"></select>
            </label>
            <label class="modal-field">
              <span>名称</span>
              <input id="role-name" type="text" placeholder="请输入角色组名称" required />
            </label>
            <div class="modal-field">
              <span>权限</span>
              <div class="perm-toolbar">
                <label><input type="checkbox" id="perm-check-all" /> 选中全部</label>
                <label><input type="checkbox" id="perm-expand-all" checked /> 展开全部</label>
              </div>
              <div id="perm-tree" class="perm-tree" aria-label="权限列表"></div>
            </div>
            <div class="modal-field">
              <span>状态</span>
              <div class="radio-row">
                <label><input type="radio" name="role-status" value="active" checked /> 正常</label>
                <label><input type="radio" name="role-status" value="hidden" /> 隐藏</label>
              </div>
            </div>
          </form>
        </div>
        <footer class="modal-foot">
          <button class="panel-btn" id="role-modal-cancel" type="button">重置</button>
          <button class="panel-btn primary" id="role-modal-submit" type="button">确定</button>
        </footer>
      </div>
    </div>

    <style>
      /* 轻量模态样式（与 gifts.html 保持一致） */
      .modal-mask{position:fixed;inset:0;background:rgba(15,23,42,.45);display:flex;align-items:center;justify-content:center;z-index:2000;padding:16px}
      .modal-card{width:min(880px,100%);background:#fff;border:1px solid var(--border);border-radius:14px;box-shadow:0 24px 60px rgba(15,23,42,.18);display:grid;grid-template-rows:auto 1fr auto;max-height:88vh;overflow:hidden}
      .modal-head{display:flex;align-items:center;justify-content:space-between;padding:14px 16px;border-bottom:1px solid rgba(226,232,240,.8);background:linear-gradient(135deg,rgba(59,130,246,.08),rgba(236,72,153,.06))}
      .modal-head h3{margin:0;font-weight:400;font-size:14px}
      .modal-close{border:none;background:transparent;font-size:20px;line-height:1;cursor:pointer;color:#64748b}
  /* 使内容区可滚动，避免底部按钮被截断 */
  .modal-body{padding:18px 16px; overflow:auto; min-height:0}
      .modal-field{display:grid;gap:8px;margin:10px 0}
      .modal-field > span{font-size:12px;color:#1f2937;font-weight:600}
      .modal-field input, .modal-field select{padding:10px 12px;border-radius:12px;border:1px solid rgba(148,163,184,.35);background:rgba(255,255,255,.96)}
      .radio-row{display:flex;gap:16px;align-items:center}
      /* 权限树样式 */
      .perm-toolbar{display:flex;gap:16px;align-items:center;margin-bottom:8px;color:#334155;font-size:12px}
      .perm-tree{max-height:320px;overflow:auto;border:1px solid rgba(226,232,240,.8);border-radius:12px;padding:10px;background:rgba(248,250,252,.85)}
      .perm-group{border:1px solid rgba(148,163,184,.25);border-radius:10px;padding:10px;margin-bottom:10px;background:#fff}
      .perm-head{display:flex;align-items:center;gap:8px;font-weight:600;color:#0f172a;margin-bottom:8px}
      .perm-children{display:grid;gap:8px;grid-template-columns:repeat(auto-fit,minmax(140px,1fr));padding-left:4px}
      .perm-group.perm-collapsed .perm-children{display:none}
  /* 底部操作按钮区域居中并排显示 */
  .modal-foot{display:flex;justify-content:center;align-items:center;gap:18px;padding:14px 16px;border-top:1px solid rgba(226,232,240,.8);background:linear-gradient(135deg,rgba(248,250,252,.85),rgba(241,245,249,.85))}
  .modal-foot .panel-btn{min-width:96px}
    </style>

    <script type="module" src="/admin/static/perm-guard.js"></script>
    <script type="module" src="/admin/admin-roles.js"></script>
  </body>
</html>

